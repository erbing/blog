# ç¬¬äºŒç«  - 06ï¼šwebpack 4  çš„åº”ç”¨æ„å»º

[TOC]

## ä¸€ã€ç‰ˆæœ¬
> å½“å‰ webpack ç‰ˆæœ¬ ï¼š v4.18.0
```javascript
webpack -v
// 4.18.0
```
åŒä¹‹å‰çš„ç‰ˆæœ¬ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯éœ€è¦ å…¨å±€å®‰è£… webpack-cli

```javascript
webpack-cli -v
// 3.1.0
```

> æ€è€ƒè¿™ä¸ª webpack-cli æ˜¯çœŸçš„æœ‰ç”¨ä¹ˆï¼Ÿ å…¶å®å¯¹äºæˆ‘æ¥è®²æ„Ÿè§‰å¾ˆé¸¡è‚‹ï¼Œè™½ç„¶å®ƒæ˜¯å‡ºç°æ˜¯ä¸ºäº†è®©æˆ‘webpack é›¶é…ç½®åŒ–ï¼Œä½†å°±ç›®å‰ webpack-cli çš„ä½“éªŒæ¥è®²ï¼Œè¿˜æ˜¯æ¯”è¾ƒé¸¡è‚‹ï¼Œåœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘è¿˜æ˜¯æ¯”è¾ƒå–œæ¬¢ diy ï¼Œè¿™æ ·è‡ªç”±çš„æŠ˜è…¾æ–¹å¼ï¼Œ é›¶é…ç½®ï¼Œå°±æ„å‘³ç€ä½ è¦ä¸º é«˜åº¦å®šåˆ¶åŒ–ä½œå‡ºç‰ºç‰²ã€‚

---

> è¿™è®©æˆ‘æƒ³èµ·äº†ä¹‹å‰é¢è¯•å¾ˆå¤šå‰ç«¯å¼€å‘çš„æ—¶å€™ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„é—®é¢˜ï¼Œå¦‚ä½•æ­å»ºä¸€ä¸ªæœ€ç®€å•çš„ webpack çš„å¼€å‘æ¶æ„ï¼ŒJS å‹ç¼©ä¸€ä¸‹ï¼Œ LESS é¢„ç¼–è¯‘ä¸€ä¸‹ï¼Œ CSS å‹ç¼©ä¸€ä¸‹ã€‚è¿™ç±»ï¼Œå¾ˆå¤šä¹ æƒ¯äº†ç”¨ vue-cli çš„åŒå­¦å°±æ‡µé€¼äº†ï¼Œå› ä¸ºä»–ä»¬è®¤ä¸º æ¶æ„å°±æ˜¯ç”¨åˆ«äººçš„ä¸œè¥¿ï¼Œä½†å®é™…çš„å¼€å‘ä¸­ï¼Œå‡ºäºä¸šåŠ¡éœ€æ±‚çš„éœ€è¦ï¼Œæˆ‘ä»¬çš„æ¶æ„éœ€è¦æ›´åŠ å¤šçš„çµæ´»æ€§å’Œé«˜åº¦å¯å®šåˆ¶åŒ–æ€§ã€‚ æ‰€ä»¥è¿™æ‰æ˜¯å†™è¿™ç¯‡æ–‡ç« çš„ å‡ºå‘ç‚¹ã€‚

## äºŒã€webpack çš„ä¸»ä½“æ¦‚å¿µ

> å¼€å±€ä¸€å¼ å›¾ï¼š

![](https://images2018.cnblogs.com/blog/675289/201809/675289-20180912164347947-278299644.png)

æœ¬è´¨ä¸Šï¼Œ`webpack` æ˜¯ä¸€ä¸ªç°ä»£ JavaScript åº”ç”¨ç¨‹åºçš„é™æ€æ¨¡å—`æ‰“åŒ…å™¨`(static module bundler)ã€‚åœ¨ webpack å¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šåœ¨å†…éƒ¨åˆ›å»ºä¸€ä¸ªä¾èµ–å›¾(dependency graph)ï¼Œç”¨äºæ˜ å°„åˆ°é¡¹ç›®éœ€è¦çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åå°†æ‰€æœ‰è¿™äº›ä¾èµ–ç”Ÿæˆåˆ°ä¸€ä¸ªæˆ–å¤šä¸ªbundleã€‚

> åœ¨å¼€å§‹å‰æˆ‘ä»¬éœ€è¦å…ˆç†è§£å®ƒçš„`æ ¸å¿ƒæ¦‚å¿µ`ï¼š

- å…¥å£(entry)
- è¾“å‡º(output)
- loader
- æ’ä»¶(plugins)

### 2-1ã€å…¥å£

> å…¥å£èµ·ç‚¹(entry point)

è¿™é‡Œæ˜¯ä¸€åˆ‡å¼€å§‹çš„èµ·ç‚¹ã€‚é¢å¯¹å®é™…çš„ä¸šåŠ¡æ¥è®²çš„è¯ï¼Œå¯ä»¥åˆ†ä¸ºå•é¡µé¢( SPA ) å’Œå¤šé¡µé¢ã€‚é‚£ä¹ˆä»Šå¤©å°±é’ˆå¯¹è¿™2ç§æƒ…å†µæ¥åˆ†åˆ« ä»‹ç»ä¸‹ åˆ©ç”¨ webpack è¿›è¡Œé¡¹ç›®æ¶æ„çš„éœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚

### 2-1-1ã€å•é¡µé¢å…¥å£

####  2-1-1-1ã€å®ç°çš„å†™æ³•ï¼š
> webpack.config.js

```javascript
module.exports = {
	entry: './app.js'
}
```

####  2-1-1-2ã€åŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡å¯¹è±¡è¯­æ³•æ¥è§£å†³ä¸åŒåœºæ™¯çš„é—®é¢˜ï¼š

> webpack.config.js

```javascript
module.exports = {
	entry: {
		app: './app.js',
		vendors: './src/JQ.js'
	}
}
```

###  2-1-2ã€å¤šé¡µé¢åº”ç”¨çš„å…¥å£

>  webpack.config.js
```javascript
module.exports = {
  entry: {
    pageOne: './src/pageOne/index.js',
    pageTwo: './src/pageTwo/index.js',
    pageThree: './src/pageThree/index.js'
  }
};
```

ä½†æ˜¯è¿™é‡Œåªæ˜¯äººå·¥çš„å»é…ç½®äº†å¤šé¡µé¢ï¼Œå…¶å®å¾ˆæ˜æ˜¾è¿™ç§åšæ³•å¾ˆä¸èªæ˜ã€‚
æ‰€ä»¥ä½ éœ€è¦ä¸€ä¸ªèªæ˜çš„åšæ³•ï¼Œè¿™é‡Œå°±å¤§è‡´è®²ä¸€ä¸‹æ€è·¯ã€‚ é€šè¿‡
ï¼ˆ ' ./src/**/*.js' ï¼‰ åŒ¹é…åˆ° å¤šé¡µé¢åˆ°æ–‡ä»¶å…¥å£è·¯å¾„ï¼Œç„¶å é€šè¿‡ glob.sync(globPath)
è·å–åˆ°å…¨éƒ¨è·¯å¾„ï¼Œæ‹¿åˆ°æ¯ä¸ªé¡µé¢çš„ å…¥å£æ–‡ä»¶è·¯å¾„ã€‚ æœ€åä¼ å€¼ç»™ webpack çš„ entry å¯¹è±¡ã€‚ 



### 2-2ã€è¾“å‡º

####  2-2-1ã€å•é¡µé¢ è¾“å‡º

> webpack.config.js
```javascript
module.exports = {
  output: {
    filename: 'bundle.js',
    path: '/home/proj/public/assets'
  }
};
```

####  2-2-2ã€å¤šé¡µé¢ è¾“å‡º

> webpack.config.js
```javascript
module.exports = {
  output: {
    filename: '[name].js',
    path: __dirname + '/dist'
  }
};
```
 
### 2-3ã€loader

è¿™é‡Œçš„ loader å°±åƒä¸€ä¸ªåˆä¸€ä¸ªçš„åŠ å·¥å‚ä¸€æ ·ï¼ŒæŠŠä½ è¾“é€ç»™ åŠ å·¥äº§çš„åŸææ–™åŠ å·¥ç”Ÿæˆä½ æƒ³è¦çš„æˆå“æˆ–è€…åŠæˆå“ã€‚æœ€åå‡ºå‚ï½

æœ‰ç”¨è¿‡ gulp ç±»ä¼¼çš„æ„å»ºå·¥å…·ç­‰åŒå­¦ å°±å¾ˆ å®¹æ˜“ç†è§£ï¼Œè¿™é‡Œçš„ä¸€ä¸ªä¸ªçš„ loader å°±æƒ³å½“ä¸€ä¸€ä¸ªä¸ªçš„ taskï¼Œ è¿™ä¸ªä»»åŠ¡å®Œæˆå°±ä¼šäº¤ç»™ä¸‹ä¸€ä¸ªäººï¼Œç›´åˆ°æ•´ä¸ªæµæ°´çº¿å·¥ä½œè·‘å®Œï½

åœ¨æ›´é«˜å±‚é¢ï¼Œåœ¨ webpack çš„é…ç½®ä¸­ loader æœ‰ä¸¤ä¸ªç‰¹å¾ï¼ˆdemoï¼‰ï¼š

>webpack.config.js

```javascript
const path = require('path');

module.exports = {
  output: {
    filename: 'my-first-webpack.bundle.js'
  },
  module: {
    rules: [
      { test: /\.txt$/, use: 'raw-loader' }
    ]
  }
}
```

å…¶ä¸­æœ‰ä¸‰ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š

1ã€loader çš„ç‰¹å¾ä¹‹ä¸€ï¼š `test` å±æ€§ï¼Œç”¨äºæ ‡è¯†å‡ºåº”è¯¥è¢«å¯¹åº”çš„ loader è¿›è¡Œè½¬æ¢çš„æŸä¸ªæˆ–æŸäº›æ–‡ä»¶ã€‚

2ã€loader çš„ç‰¹å¾ä¹‹äºŒï¼š `use` å±æ€§ï¼Œè¡¨ç¤ºè¿›è¡Œè½¬æ¢æ—¶ï¼Œåº”è¯¥ä½¿ç”¨å“ªä¸ª loaderã€‚

3ã€åœ¨ webpack é…ç½®ä¸­å®šä¹‰ loader æ—¶ï¼Œè¦å®šä¹‰åœ¨ `module.rules` ä¸­ï¼Œè€Œä¸æ˜¯ `rules`
 
 
####  2-3-1ã€å¦‚ä½•ç¼–å†™ä¸€ä¸ª loader

å‰æœŸè¿™é‡Œä¹Ÿåªæ˜¯å¤§æ¦‚çš„äº†è§£ä¸€ä¸‹ï¼Œåœ¨åé¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šæ‰‹æŠŠæ‰‹çš„æ•™ä½  æ‰‹å†™ä¸€ä¸ª loader

è¿™ç¯‡æ–‡ç« è¿˜åªæ˜¯æ•™ä½ å¦‚ä½•ä½¿ç”¨ webpackã€‚ æ•¬è¯·æœŸå¾…åé¢çš„æ–‡ç« å§ ğŸ˜


### 2-4ã€plugins

æ’ä»¶æ˜¯ webpack çš„`æ”¯æŸ±`åŠŸèƒ½ã€‚webpack è‡ªèº«ä¹Ÿæ˜¯æ„å»ºäºï¼Œä½ åœ¨ webpack é…ç½®ä¸­ç”¨åˆ°çš„ç›¸åŒçš„æ’ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼

æ’ä»¶ç›®çš„åœ¨äºè§£å†³ loader `æ— æ³•å®ç°`çš„å…¶ä»–äº‹ã€‚

> webpack.config.js

```javascript

module.exports = {
  entry: './path/to/my/entry/file.js',
  output: {
    filename: 'my-first-webpack.bundle.js',
    path: path.resolve(__dirname, 'dist')
  },
  module: {
    rules: [
      {
        test: /\.(js|jsx)$/,
        use: 'babel-loader'
      }
    ]
  },
  plugins: [
    new HtmlWebpackPlugin({template: './src/index.html'})
  ]
}

```


####  2-4-1ã€å¦‚ä½•ç¼–å†™ä¸€ä¸ªplugins

ä¸€æ ·çš„ï¼Œå‰æœŸè¿™é‡Œä¹Ÿåªæ˜¯å¤§æ¦‚çš„äº†è§£ä¸€ä¸‹ï¼Œåœ¨åé¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šæ‰‹æŠŠæ‰‹çš„æ•™ä½  æ‰‹å†™ä¸€ä¸ª plugins

è¿™ç¯‡æ–‡ç« è¿˜åªæ˜¯æ•™ä½ å¦‚ä½•ä½¿ç”¨ webpackã€‚ æ•¬è¯·æœŸå¾…åé¢çš„æ–‡ç« å§ ğŸ˜


## ä¸‰ã€å¦‚ä½•ä½¿ç”¨



## å››ã€é¿å…é—®é¢˜

